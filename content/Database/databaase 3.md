![[Pasted image 20241212091515.png]]

اینجا وقتی که یه چیزی رو تغییر میدیم میاد script اش رو برامون مینویسه ، بعد این اسکریپت ها رو به ترتیب که تغییرات رو اعمال کردیم در جایی ذخیره میکنیم با تاریخ و زمان برای این که بعدا اگر خواستیم آپدیت انجام بدیم ازشون استفاده کنیم 

برای اکتیو کردین این صفحه باید از این مسیر بریم :

![[Pasted image 20241212092140.png]]


خوب حالا میخوایم  x0 رو اضافه کنیم 
![[Pasted image 20241212092314.png]]
 

یا میایم با insert column اون بالا اضافه اش میکنیم 

![[Pasted image 20241212092350.png]] 


![[Pasted image 20241212092426.png]]

دستور inset into  
حالا نکته ای که وجود داره اینه که وقتی که میخوایم یه فیلد جدید رو اون وسط اضافه کنیم باید اول یه جدول دیگه ساخته بشه و بعد تمامی اطلاعات جدول بره با اون فیلد جدیده بره توی اون جدول جدیده و بعد اعمال انتقال کامل انجام بشه و جدول قبلی کامل drop بشه و بعد این جدول جدیده اسمش تغییر کنه به اسم اون جدول قدیمی و اولیه 
این عملیات خیلی خطرناکه و توی محیط transaction انجام میشه 
برای همین گفته میشه که توی نوشتن جای این که فیلد جدید کجا اضافه بشه وسواس نداشته باشیم 
چون در موقعق که بیایم فیلد جدید رو در آخر اضافه کنیم این اتفاق نمیوفته 
چرا چون در این حالت میاد در هارد به اون قسمتی که هست این فیلد رو در آخرش اضافه میکنیم ولی در حالتی قبلی باید باید اون وسط فضای اون قسمت اختصاص داده شده به جدول باید بیاد اعمال کنه 



![[Pasted image 20241212093105.png]]

اگر این تیک رو فعال کنیم جلوی اون کاری که بخوایم اون وسط فیلیدی رو اضافه کنیم رو میگیره 

میرسیم به قسمت constrains که میشد قیود و محدود کننده ها که 6 تا هستند 
اولیش میشه primery key هستش 
دومیش foreign key هستش 
سومش میشه check 
چهارمی unique 
پنجمی allow  null 
ششمی default 

کوئری نام سهیل -- خطا 
کوئری سهیل مونسی -- خطا ممکنه چندین تا از این اسم و فامیل داشته باشیم 
برای همین نیاز به کلید اصلی داریم که مقدارش null نباشه و uniqe باشه 

حالا میایم از این محدود کننده ها استفاده میکنیم که مقدار اون فیلد uniqe باشه و null نباشه 

![[Pasted image 20241212094251.png]]

برای ست کردن  
![[Pasted image 20241212094313.png]]
![[Pasted image 20241212094321.png]]

کلید میاد کنارش و allow null هم غیر فعال میشه 
اگر بخوایم تکراری وارد کنیم ارور میده 
![[Pasted image 20241212094357.png]]

![[Pasted image 20241212094403.png]]


یک column اطلاعاتی یا ترکیبی از چند تا column اطلاعاتی بیایم و یک کلید اطلاعاتی بسازیم 
ماکزیمم این ترکیب میشه 16 تا 
در گذشته میومدن شماره اسم فامیل شماره شناسنامه نام پدر محل تولد همه اینا رو با هم ترکیب میکردن 
ولی وقتی که کد ملی اومد که برای همه uniqe بود دیگه یکی primery key داریم 

![[Pasted image 20241212094919.png]]

اینطوری باید با گرفتن و select کردن با control بیایم دو تا کلید اصلی در نظر بگیریم 
![[Pasted image 20241212095013.png]]

این جا چون هر دوتا شخص مشخصاتشون کاملا در دوتا column که به عنوان کلید اصلی تعیین کردیم یکسان هستش و ارور میده و در بالا اینطور نیست

![[Pasted image 20241212095047.png]]

کد پستی ، شماره تلفن چون قابل خرید و فروشه نمیشه به عنوان کلید اصلی ازش استفاده کنیم 

خوب حالا میرسیم به کلید خارجی : primery key های این جدول هستند که در جدوال دیگه ازش استفاده میشه 


![[Pasted image 20241212100202.png]]

اینجا معلوم نیست که لستان فارس چقدر جمعیت داره 
راه حل :
![[Pasted image 20241212100235.png]]

![[Pasted image 20241212100243.png]]
![[Pasted image 20241212100352.png]]

![[Pasted image 20241212100405.png]]

![[Pasted image 20241212100547.png]]

قوانین refenrial integrity role
حق حذف پدری که فرزند داره رو ندارم - 
حق افزودن فرزند با کد پدر نامشخص رو نداریم 

حق افزودن فرزند با کد پدر null رو داریم در صورتی که foregn key قابلیت allow null رو داشته باشه 

حق آپدیت کردن کد پدر رو نداریم با cascade امکان پذیره


![[Pasted image 20241212102050.png]]



![[Pasted image 20241212102101.png]]

برای کلید خارجی میایم ترکیب اسم اون جدول ها رو میزاریم 
باید ملید خارجی و کلید اصلی باید از یک جنس باشند یعنی int باشن هر دو 

![[Pasted image 20241212102329.png]]

خوب forgin key و releshenship در Sql هم معنی هستن 

![[Pasted image 20241212102415.png]]

![[Pasted image 20241212102424.png]]

![[Pasted image 20241212112249.png]]


![[Pasted image 20241212102434.png]]

![[Pasted image 20241212102502.png]]


![[Pasted image 20241212102517.png]]

بعضی از اوقات به خاطر یه شرایط خاص ممکنه که کلید اصلی و کلید خارجی رو نیایم ست کنیم و بعد بیایم به صورت منطقی از این خاصیت که دارن برای روابط بین جدول ها استفاده کنیم 

حالا اگر دو تا داشتیم 

![[Pasted image 20241212112409.png]]

![[Pasted image 20241212112421.png]]

![[Pasted image 20241212112532.png]]

به تعداد فیلد هایی که در جدول پدر primery key در نظر گرفتیم باید در جدول فزرند به همون تعداد فیلد داشته باشیم 

اینجا میتوینم 2 تا کد 1 داشته باشیم چون 2 تا premiry key داریم که جلوتر میایم و فقط یکی رو در نظر میگیریم 

![[Pasted image 20241212112919.png]]

![[Pasted image 20241212112951.png]]

![[Pasted image 20241212113058.png]]


نمیتونیم حذفش کنیم قانون 1 
چون اینجا tehran در جدول پدر هستش و ازش در جدول فرزند داره ازش استفاده میشه و ما نمیتونیم دیتایی که داره در جدول های دیگه استفاده میشه رو پاک کنیم 
![[Pasted image 20241212113124.png]]

خوب قانون سوم داره میگه که حق افزودن فرزند با کد پدر نامشخص رو نداریم و اینجا همونطوری که میبینیم ارور میگیریم چون که اصلا state code و state name در جدول پدر وجود نداره برای همین ارور میگیریم 

![[Pasted image 20241212113143.png]]

ولی میتونیم null بدیم 

![[Pasted image 20241212113200.png]]

یدونه ای کردیم 
![[Pasted image 20241212113239.png]]

برای این که جدول های رو در کنار هم بزاریم 
![[Pasted image 20241212113252.png]]

خوب 
![[Pasted image 20241212120420.png]]

اینجا برای مواقعی هستش که وسط پروژه میخوایم foregin key رو اضافه کنیم 
اگر اون دیتا داخلش دیتا خراب باشه یعنی به طور مثال اطلاعات اون جدول کد پدر نامشخص داشته باشه و ... 
اگر فعالش کنیم میره کل دیتاش رو چک میکنه حتی اگر یه دونه هم دیتا خراب داشته باشه اجازه ست کردن foregn key رو نمیده 
اگر هم نه کاری نداره و انجامش میده 
![[Pasted image 20241212120855.png]]

برای نگهداری دیتا میتونیم از replication استفاده کنیم ، دو تا سیستم داریم که یدونه دیتا بیس داریم و شب به شب دیتای سیستم اول میره توی سیستم دوم با استفاده از replication 
خوب نکته ای که وجود داره اینه که همه ی جداول تغییر نمیکنه مثلا مثل جدول استان ها ، چون همیشه ثابت هستن 
ولی در مورد خاص مثل جداشدن استان البرز 
اگر yes باشه اولویت رو به refecial integrity  میده یعنی اگر تمام اطلاعات درست نباشه نمیزاره انجام بشه 
ولی اگر no باشه این عملیات انجام میشه و اولویت با replication هست ولی ممکنه اطلاعات انتقالی توش خطا وجود داشته باشه 

![[Pasted image 20241212121629.png]]

خوب این قابلیت برای این هستش که میخوایم یه دیتایی رو مثلا از اکسل به دیتابیس انتقال بدیم اینجا رو اول no میدیم و بعد میریم و بعدش اگر خواستیم yes اش میکنیم

نکته ای  که وجود داره در حالت no باید check existing data on create هم no باشه 

مثلا میخوایم یه دیتایی که بلاتکلیفه رو بهش یه چیزی Assign کنیم مثلا میدیم کد سایر و بعدا میریم درستش میکنیم 
![[Pasted image 20241212121913.png]]


اگر no action باشه نمیزاره که دیتا حذف بشه 
اگر cascade باشه به صورت آبشاری دیتا ها رو حذف میکنه یعنی اینطوری که اگر tehran رو حذف کنیم تمام دیتاهایی که بهش وصله هم پاک میشه 

این در جاهایی مثل فاکتور فروش در سوپر مارکتی ها استفاده میشه ، مثلا فاکتور صادر شده توش یه سری آیتم ها هستن حالا فرض کنید که مشتری پول نداشته باشه و اینجا فروشنده میزنه و تمام فاکتور رو پاک میکنه 
خوب set default : اگر میخوای دیتایی رو حذف کنیم میایم به جاش یه مقدار از پیش قرار داده شده درش قرار داده میشه 
حالت بعدی هم null هستش 

![[Pasted image 20241212122627.png]]

موارد بعدی برای update هستش : 
توی آپدیت اگر روی default باشه وقتی که تغییرش بدیم و درست نباشه مقدار دیفالت میگیره 

![[Pasted image 20241212123129.png]]

![[Pasted image 20241212123151.png]]
![[Pasted image 20241212123300.png]]

اسم خوب دادن به این دلیله که توی اون اروره بهمون نشون میده 
![[Pasted image 20241212123337.png]]
ارور دیتا تایپ هستش چون دیتا تایپمون 255 تا بیشتر نمیتونه بگیره ولی ما 256 دادیم 

این که ما چک کردن ها رو در هم لایه برنامه و هم لایه دیتابیس انجام بدیم بهتره چون ممکنه از چند مدل برنامه با کد های مختلف بخوان با دیتا بیس کار کنن 

![[Pasted image 20241212123918.png]]


خوب uniqe constrans میتونه یدونه مقدار null بگیره !

![[Pasted image 20241212124541.png]]

این همون constrans default هستش 
![[Pasted image 20241212124602.png]]

این هم allow null هم میشه constran 


یه دونه from داریم توی هر select 
![[Pasted image 20241212130356.png]]

از اینجا به بعد همیش optinal باشه 
 یدونه from میتونیم بینهایت join داشته باشیم 
فیلتر در قسمت where condition هندل میشه مثلا فیلتر کردن بر اساس جنسیت ، سن و...
قسمت group by  رو داریم مثلا جدول واریزی داریم که کد ملی و واریزی داریم 

اگر بخوایم بر اساس کد ملی دسته بندی کنیم و بعد بیایم روی colmn وایزی sum بزنیم

![[Pasted image 20241212131043.png]]

خوب قسمت having condition در   group by ها استفاده میشه حالا اینجا اینطوری ازش استفاده میشه که مثلا اونهایی رو میخوایم که مجموع واریزیشون بیشتر از یه مقداری باشه

شروع بر روی aggrigate function در داخل having condition کنترل میشه 


خوب sort کردن هم داریم
یک جدول رو میتونیم بر اساس فقط یک فیلد sort کنم 
احمد احمد 
احمد برزویی 
اول بر اساس نام sort میشه و فیلد های بعدیش هم همینطوری یعنی بعدیش که فامیلی هست هم sort میشه 
![[Pasted image 20241212131655.png]]

![[Pasted image 20241212131948.png]]

اون ریال هم یک کاراکتره 
اگر اسم جلال رو به صورت اولی نوشته باشیم ولی به صورت دومی سرچ کنیم coalation قابلیت compare کردن هم داره و میتونه پیدا کنه 
