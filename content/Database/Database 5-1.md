بک آپ گیری رو معمولا ادمین انجام میده ولی دونستنش خوبه :

![[{A481875A-6445-4B3B-8690-42FDB4797ECF}.png]]

![[{263155D2-10F5-4AB4-937C-827FACBAD5F4}.png]]

اون فیلد اول میایم و اسم دیتابیس رو انتخاب میکنیم از توی این انجین 

فیلد بعدی داره میگه که نوع و جنس ریکاوریش از نوع full هستش 

نوع full میاد از تمامی فایل های mdf و ndf به صورت یکپارچه بک آپ میگیره این یعنی این که اگر این بک آپ جای دیگه ببریم و  اجرا کنیم دقیقا میشه همون دیتا بیس با همون ساختار و اطلاعات و همه چی 

 نوع diffrential میاد نسبت به بک آپ قبلی چیزهایی که اضافه شده رو میاد بک آپ میگیره 

 اول میایم یه فول بک اپ میگیریم و بعدش اگر diffrential بگیریم میاد نسبت به full اون چیزهایی که اضافه شده رو بک آپ میگیره و بعدی رو هم اگر diffrential بگیریم نسبت به بک آپ diffrential قبلی میاد اطلاعات و چیزهایی که اضافه شده رو بک آپ میگیره 

حجم diffrential ها کمتره ولی نکته ای که وجود داره اینه که باید این مدل بک ها پشت سر هم وجود داشته باشن.

اگر قسمتی از این مدل بک آپ ها حذف بشه اطلاعات اون قسمت هم حذف میشه و از بین میره 

اگر مدل recovery mode از نوع full نباشه گزینه ی transactinal log رو نمیبینیم .

چون اگر recovery model از نوع full باشه تمامی اطلاعات در LDF موجوده 
اگر simple باشه فقط اون قسمت آخرش رو داریم 

نوع transactianl log فقط بک آپ فایل های LDF هستش 

مورد بعدی این رو داره میگه که آیا بیایم از کل دیتابیس بک آپ بگیریم   و مورد بعدی به صورت کاستوم از اون قسمتی که میخوایم میتونیم بک آپ بگیریم :

![[{35328AFC-C264-4F82-8C0E-330427CCF68D}.png]]

 مورد بعدی داره میگه که از که دیتابیس رو توی سیستم خودمون بک آپ بگیریم یا ببریم در Share و یه سیستم  دیگه 
![[{D9462184-C0A8-4370-9BD7-5F8B4E248744}.png]]

خوب برای اسم هم این رو در نظر بگیرید که تاریخ هم بزاریم :
![[{A37B271B-70FF-405B-B988-0891173F9D7A}.png]]

اگر اسم بک آپ ها یکسان باشه میره دوتا فایل رو توی هم میریزه و تمامی دیتا هم با هم قاطی میشه و دیگه نمیشه ازشون استفاده کرد  

جلوتر با tsql میایم بهش ساعت و دقیقه هم میدیم چون در طول روز ممکنه که چند بار بخوایم بک آپ بگیریم 

![[{F39A34E9-F452-41DF-8BD6-7B95502EFEDF}.png]]

خوب اگر verfiy backup when finished خوب با زدن این تیک بعد از این که بک آپ تموم شد میره دوباره میارتش به صورت background task و چکش میکنه و بعد اگر اوکی بود پیام میده که همه چی اوکیه ، این روش یکم شاید زمان بیشتری ببره ولی مطمئن تره 

![[{4C112A50-9E45-4739-B1D4-67D362A57920}.png]]

خوب اینجا نکته ای که وجود داره اینه که اگر زدیم که بک آپ رو به صورت فشرده در بیاره 

![[{B9C5490F-3587-4D75-B103-7435DE7C79EB}.png]]

حتما اون تیک مرحله قبل رو بزنیم که حتما چکش کنه 

![[{BF8CBF5D-43E6-40B9-9FE1-C4E8EBC13A7D}.png]]

این جا ما یه چیزی داریم که هیچ پسوندی نداره ولی داستانش اینه که اونجایی که داریم براش اسم میزاریم بیایم و پسوند .bak رو بهش اضافه کنیم  

نکته ی که وجود داره اینه که باج افزارها اولین فایلی که دنبالش میگردن همین .bak هستش 

خوب حالا اگر بخوایم یه بک آپی رو برگردونیم اگر بخوایم این کار و کنیم اول بهتره که اسم اون دیتا بیس که الان توی دیتا بیس هستش رو عوض کنیم و مسیرش رو هم با اون مسیری که بک آپ هستش متفاوت بزاریم و بعد بک آپ رو بیاریم بالا   

![[{ECA36B8C-370A-4695-AEE4-7A20438D390E}.png]]

الان میخوایم دیتابیس test 12 رو بیایم restor کنیم  
![[{862D7293-923F-4FF7-8BCC-E74987A5E88D}.png]]

![[{7DC45B18-2B37-44FD-83D9-4629EA32C77B}.png]]

خوب توی حالت بالا همه چه اوکی restor میشه 

حالا میخوایم یه دیتابیسی رو که در حال حاضر توی engine هستش رو بریم بک آپش رو جداگانه بیاریم 

به طور مثال ما الان pubs رو داریم و میریم از روی بک آپ pubs اون رو resor میکنیم 

![[{4AEC8A2D-917C-48AC-84C7-81C8F3413C87}.png]]


اینجا اسمش رو تغییر میدیم و وقتی که اسمش رو تغییر میدیم خودش به صورت اتوماتیک اسم فایل mdf  و ldf رو تغییر میده
 ![[{101872C7-DE69-4A57-9D19-4B1C22233F5A}.png]]


![[{0C74BCA0-6BA2-455E-887D-EC2610361DC2} 1.png]]

حالا ما برای این که همه چی اوکی باشه باید فایل ذخیره سازیشون رو هم باید جدا کنیم یعنی یه جایی به جز فولدی DATA که دیتابیس قبلی pubs داخلش هست انتخاب کنم ولی انجا این کارو نمیکنم 

و نتیجه اش میشه این :

![[{A17C2F68-0860-4956-8039-9B898F385F9C}.png]]

و دیگه از اون pubs (restoring) نمیشه استفاده کرد و کلا میپوکه 

![[{2D3779B9-2221-4760-BD4A-577E56677237}.png]]   

اینجا به دلیل این که این دوتا دیتابیس هر دو یه فایل مشترک دارند به مشکل میخورن  و خوده engine هم فکر میکنه این دوتا یکی هستن و یکی رو میبره روی mode restoring و دسترسی بهش قطع میشه  

اینجا دیتابیس pubs یه file stram که فایل های بیشتر از 2 gb رو توش ذخیره میکنن داره که وقتی که میخواد چیزی توشون ذخیره بشه میره توی یه قسمت دیگه از هارد و فقط آدرسش میاد داخل دیتا بیس قرار میگیره  و بعد چون file stream هاشون هم نام هستند این مشکل ایجاد میکنه ، اینجا ما به دستورات admin نیاز داریم

خوب حالا برای این که یه script رو باز کنیم این کار و میکنیم :

![[{DC4F7B39-89CB-473F-87EC-6ACF57C142F0}.png]]







![[Pasted image 20241226091026.png]]

![[Pasted image 20241226091137.png]]

اولی : وقتی که میخواد بشمره کل رکورد رو میاره توی رم و بعد میشماره  
دومی : فقط میره  title id رو میاره و میشمره 
دومی سرعتش خیلی بیشتره 

نکته :null در توابع aggrigate تاثیر داده نمیشود 
بهترین حالت برای شمارش اعضای جدول اینه که روی primery key ها بزنیم چون هیچوقت null نمیشن 

 ![[Pasted image 20241226091427.png]]

چون وقتی که میخوایم ازش به صورت Nested استفاده کنیم وقتی که no cloumn name باشه نمیتونیم توی حالت nested ازش استفاده کنیم 

![[Pasted image 20241226091435.png]]

![[Pasted image 20241226091545.png]]

وقتی که SUM داره میگیره NULL ها رو تاثیر نمیده

![[Pasted image 20241226093738.png]]


![[Pasted image 20241226094753.png]]


![[Pasted image 20241226095035.png]]

ترتیب بر اساس استاندارد Sql 



![[Pasted image 20241226095503.png]]



![[Pasted image 20241226100546.png]]

![[Pasted image 20241226100604.png]]

![[Pasted image 20241226100656.png]]




![[Pasted image 20241226105349.png]]


![[Pasted image 20241226105525.png]]

![[Pasted image 20241226110059.png]]




![[Pasted image 20241226111600.png]]


سرعت left , Right بیشتر است چون inner هر دو طرفه چک میکنه ولی left , right یک 



طرف رو چک میکنن

![[Pasted image 20241226113610.png]]

![[Pasted image 20241226115355.png]]

![[Pasted image 20241226115511.png]]




